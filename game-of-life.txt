;This is the setup procedure
to breishis
spawn-creatures
make "hours-left 16
make "secs-in-hour 2
make "energy 90
make "happiness 30
change-clock ;;reset the clock
resett

make-energy-happiness-bars
end




to play-game
breishis
launch [ forever [move-char .1] ]
launch [ forever [ keep-time ] ]
end



;moves the char in a certain heading a certain distance :speed
to move-char :speed
if key? [
main-char,
    let [key readchar]
    if (ascii :key) = 28        ;;if left arrow key is pressed
        [seth 270 fd :speed]
    if (ascii :key) = 29        ;;if right arrow key is pressed
        [seth 90 fd :speed]
    if (ascii :key) = 30        ;;if forward key is pressed
        [seth 0 fd :speed]
    if (ascii :key) = 31        ;;if left arrow key is pressed
        [seth 180 fd :speed]
]
fd :speed
end




;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;HELPER FUNCTIONS;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;





;;;;;;;;;;;;;;;;;;;;;;BEGIN SPAWN PROCEDURES;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
to spawn-creatures
spawn-you
spawn-good 1        ;Spawns 1 + number you enter good creatues with type good
spawn-bad 1     ;Spawns 1 + number you enter bad creatues with type bad
end


; Spawns the main character in the beginning
to spawn-you
newturtle "main-char
setx 0
sety 0
st
;when [touching? who ] [affect-me]
end

to affect-me
[if turtle = good
        [add-happy
        add-energy
        remove-good
    ]
    else
]
end

;Spawns good characters
to spawn-good :num-good
spawn-initial-good
repeat :num-good [spawn-more-good]
end

;Spawns bad characters
to spawn-bad :num-bad
spawn-initial-bad
repeat :num-bad [spawn-more-bad]
end


; spawns an intial good turtle which will be cloned
to spawn-initial-good
newturtle "good
setx random 735     ;random from 0-734 which is world size
sety random 427
setsh pick [love exercise money music]      ;pick a shape from 1-4 which represent good things
giveturtle "type
settype "good       ;give the turtle a good type
st
end

; spawns more good turtles
to spawn-more-good
clone "good
setx random 735     ;random from 0-734 which is world size
sety random 427
setsh pick [love exercise money music]      ;pick a shape from 1-4 which represent good things
settype "good       ;give the turtle a good type
st
end

; spawns an intial bad turtle which will be cloned
to spawn-initial-bad
newturtle "bad
setx random 735     ;random from 0-734 which is world size
sety random 427
setsh pick [acne carAccident obesity sickness]      ;pick a shape from 1-4 which represent good things
giveturtle "type
settype "bad        ;give the turtle a good type
st
forever [chase "main-char .1]
end

; spawns more bad turtles
to spawn-more-bad
clone "bad
setx random 735     ;random from 0-734 which is world size
sety random 427
setsh pick [acne carAccident obesity sickness]      ;pick a shape from 1-4 which represent good things
settype "bad        ;give the turtle a good type
st
forever [chase "main-char .1]
end

;;;;;;;;;;;;;;;;;;;;;;END SPAWN PROCEDURES;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; for finding ascii-key values
to show-ascii
let [key readchar]
    show ascii :key
end



;turtle chases the chasee with speed :speed
to chase :chasee :speed

towards :chasee             ;turn towards the chasee

let [dis distance :chasee]      ; get distance to chasee
ifelse (:speed > :dis)      ; if the turtle is close than speed
    [fd :dis ]              ; then move to the turtle
    [fd :speed]         ;if not, move foward speed

end



;;;;;;;;CLOCK PROCEDURES;;;;;;;;;;;;;;;;;

;Changes the time, and then changes the clock in the world
to keep-time
    wait (:secs-in-hour * 10)
    make "hours-left (:hours-left - 1)      ;increment time
    change-clock                        ;change clock text

    if (:hours-left = 0) [
        announce [the day is over]
        stopall
    ]
end


to change-clock
top                         ;move cursoe to top of page
repeat count clock [delete]     ;delete all text
insert (se :hours-left "hours "left ;insert new text
end
;;;;;;;;;;;END CLOCK PROCEDURES ;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;ENERGY/HAPPINESS BAR PROCEDURES;;;;;;;;;;;;;;;;;
to make-energy-happiness-bars
newturtle "energy-tracker
setx minus (first projectsize) / 2
sety 200
setc 85
st
rt 90
setpensize 25
pd
fd .8 * first projectsize

newturtle "happy-tracker
setx minus (first projectsize) / 2
sety 170
setc 45
st
rt 90
setpensize 25
pd
fd .3 * first projectsize

end


to increase-happiness :ammount
make "happiness :happiness + :ammount   ;increase global happiness

ask "happy-tracker [                        ;change the happiness bar
    setc 45
    fd (:ammount / 100) * first projectsize
]
end


to decrease-happiness :ammount
make "happiness :happiness - :ammount - 1   ;decrease global happiness

ask "happy-tracker [
    setc 0
    bk 1 + (:ammount / 100) * first projectsize 
]
increase-happiness 1
end


to increase-energy :ammount
if (:energy + :ammount) > 100 [
    let [ammount 100 - :energy]
]
show :ammount
make "energy :energy + :ammount     ;increase global energy

ask "energy-tracker [
    setc 85
    fd (:ammount / 100) * first projectsize
]
end


to decrease-energy :ammount
if (:energy - :ammount) < 0[
    let [ammount :energy]
]

make "energy :energy - :ammount - 1 ;decrease global energy
ask "energy-tracker [
    setc 0
    bk 1 + (:ammount / 100) * first projectsize 
]
increase-energy 1
end


;;;;;;;;;;;;;;;;END ENERGY/HAPPINESS BAR PROCEDURES;;;;;;;;;;;;;;;;;
